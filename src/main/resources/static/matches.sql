create database frequentmatchups;

use frequentmatchups;

drop table matches; 
create table matches(
	id_matches bigint(3) NOT NULL,
	country_a bigint(2) NOT NULL,
	country_b bigint(2) NOT NULL,
	goals_country_a int(2) NOT NULL,
	goals_country_b int(2) NOT NULL,
    year_match int(4) NOT NULL,
    encounter_match varchar(30) NOT NULL,
    constraint pk_matches primary key(id_matches)
);

alter table matches
add constraint fk_country_a foreign key (country_a) REFERENCES countries (id_country);
alter table matches
add constraint fk_country_b foreign key (country_b) REFERENCES countries (id_country);

insert into matches values(1,1,2,4,2,1938,"Third-place match"),
(2,1,2,7,1,1950,"Final group"),
(3,1,2,5,2,1958,"Final"),
(4,1,2,1,1,1978,"First Round"),
(5,1,2,2,1,1990,"Group Stage"),
(6,1,2,1,1,1994,"Group Stage"),
(7,1,2,1,0,1994,"Semi-finals"),
(8,3,4,1,3,1962,"Group Stage"),
(9,3,4,0,1,1966,"Quarter Finals"),
(10,3,4,2,1,1986,"Quarter Finals"),
(11,3,4,4,3,1998,"Round of 16"),
(12,3,4,0,1,2002,"Group Stage"),
(13,3,5,2,1,1994,"Group Stage"),
(14,3,5,1,0,2002,"Group Stage"),
(15,3,5,1,0,2010,"Group Stage"),
(16,3,5,3,2,2014,"Group Stage"),
(17,3,5,2,1,2018,"Group Stage"),
(18,1,6,1,2,1938,"Semi-Finals"),
(19,1,6,4,1,1970,"Final"),
(20,1,6,2,1,1978,"Third-place Match"),
(21,1,6,2,3,1982,"Second Group Stage"),
(22,1,6,3,2,1994,"Final"),
(23,1,7,0,2,1974,"Second round"),
(24,1,7,3,2,1994,"Quarter-finals"),
(25,1,7,4,2,1998,"Semi-finals"),
(26,1,7,1,2,2010,"Quarter-finals"),
(27,1,7,0,3,2014,"Third-place match"),
(28,6,8,3,1,1938,"Quarter-finals"),
(29,6,8,2,1,1978,"First Round"),
(30,6,8,0,2,1986,"Round of 16"),
(31,6,8,3,4,1998,"Quarter-finals"),
(32,6,8,5,3,2006,"Final"),
(33,7,3,4,0,1974,"Second Round"),
(34,7,3,1,3,1978,"Final"),
(35,7,3,2,1,1998,"Quarter-finals"),
(36,7,3,0,0,2006,"Group Stage"),
(37,7,3,2,4,2014,"Semi-finals"),
(38,7,3,3,4,2022,"Quarter-finals"),
(39,3,6,1,1,1974,"First Round"),
(40,3,6,0,1,1978,"First Round"),
(41,3,6,1,2,1982,"Second Group Stage"),
(42,3,6,1,1,1986,"Group Stage"),
(43,3,6,4,3,1990,"Semi-finals"),
(44,1,9,1,1,1938,"Quarter-finals"),
(45,1,9,2,1,1938,"QF(rematch)"),
(46,1,9,0,0,1962,"Group Stage"),
(47,1,9,3,1,1962,"Final"),
(48,1,9,4,1,1970,"Group stage"),
(49,1,10,4,0,1950,"Group stage"),
(50,1,10,5,0,1954,"Group stage"),
(51,1,10,2,0,1962,"Group stage"),
(52,1,10,0,0,2014,"Group stage"),
(53,1,10,2,0,2018,"Round of 16"),
(54,1,11,1,3,1934,"Round of 16"),
(55,1,11,6,1,1950,"Final group"),
(56,1,11,2,1,1962,"Group Stage"),
(57,1,11,0,0,1978,"First round"),
(58,1,11,1,0,1986,"Group stage");

insert into tb_matches_country_a values(1,1),
(1,2),
(1,3),
(1,4),
(1,5),
(1,6),
(1,7),
(3,8),
(3,9),
(3,10),
(3,11),
(3,12),
(3,13),
(3,14),
(3,15),
(3,16),
(3,17),
(1,18),
(1,19),
(1,20),
(1,21),
(1,22),
(1,23),
(1,24),
(1,25),
(1,26),
(1,27),
(6,28),
(6,29),
(6,30),
(6,31),
(6,32),
(7,33),
(7,34),
(7,35),
(7,36),
(7,37),
(7,38),
(3,39),
(3,40),
(3,41),
(3,42),
(3,43),
(1,44),
(1,45),
(1,46),
(1,47),
(1,48),
(1,49),
(1,50),
(1,51),
(1,52),
(1,53),
(1,54),
(1,55),
(1,56),
(1,57),
(1,58);

insert into tb_matches_country_b values(2,1),
(2,2),
(2,3),
(2,4),
(2,5),
(2,6),
(2,7),
(4,8),
(4,9),
(4,10),
(4,11),
(4,12),
(5,13),
(5,14),
(5,15),
(5,16),
(5,17),
(6,18),
(6,19),
(6,20),
(6,21),
(6,22),
(7,23),
(7,24),
(7,25),
(7,26),
(7,27),
(8,28),
(8,29),
(8,30),
(8,31),
(8,32),
(3,33),
(3,34),
(3,35),
(3,36),
(3,37),
(3,38),
(6,39),
(6,40),
(6,41),
(6,42),
(6,43),
(9,44),
(9,45),
(9,46),
(9,47),
(9,48),
(10,49),
(10,50),
(10,51),
(10,52),
(10,53),
(11,54),
(11,55),
(11,56),
(11,57),
(11,58);

use frequentmatchups;

create table countries(
	id_country bigint(2) NOT NULL,
	country varchar(25) NOT NULL,
    constraint pk_country primary key(id_country)
);

insert into countries values(1,"BRAZIL"),
(2,"SWEDEN"),
(3,"ARGENTINA"),
(4,"ENGLAND"),
(5,"NIGERIA"),
(6,"ITALY"),
(7,"NETHERLANDS"),
(8,"FRANCE"),
(9,"CZECHOSLOVAKIA"),
(10,"MEXICO"),
(11,"SPAIN");

select countries.country, matches.goals_country_a, countries.country, matches.goals_country_b from countries, matches
join tb_matches_country_a on tb_matches_country_a.id_country = countries.id_country
join tb_matches_country_b on tb_matches_country_b.id_matches = matches.id_matches
